coef1 <- data.frame(matrix(NA, ncol = 6))
coef2 <- data.frame(matrix(NA, ncol = 6))
coef3 <- data.frame(matrix(NA, ncol = 6))
coef4 <- data.frame(matrix(NA, ncol = 6))
coef5 <- data.frame(matrix(NA, ncol = 6))
coef6 <- data.frame(matrix(NA, ncol = 6))
for(i in 1:length(var_name_list$EEAs)){
rlts = preform_gee_exposure_prototype(X = var_name_list$cluster_exp$clusCUR6,
Y = var_name_list$EEAs[i],
adjust_cfd = T)
coef1[i,] <- rlts[2,]
coef2[i,] <- rlts[3,]
coef3[i,] <- rlts[4,]
coef4[i,] <- rlts[5,]
coef5[i,] <- rlts[6,]
coef6[i,] <- rlts[7,]
}
coef1 <- data.frame(matrix(NA, ncol = 6))
coef2 <- data.frame(matrix(NA, ncol = 6))
coef3 <- data.frame(matrix(NA, ncol = 6))
coef4 <- data.frame(matrix(NA, ncol = 6))
coef5 <- data.frame(matrix(NA, ncol = 6))
coef6 <- data.frame(matrix(NA, ncol = 6))
for(i in 1:length(var_name_list$EEAs)){
rlts = preform_gee_exposure_prototype(X = var_name_list$cluster_exp$clusCUR6,
Y = var_name_list$EEAs[i])
coef1[i,] <- rlts[2,]
coef2[i,] <- rlts[3,]
coef3[i,] <- rlts[4,]
coef4[i,] <- rlts[5,]
coef5[i,] <- rlts[6,]
coef6[i,] <- rlts[7,]
}
colnames(coef1) = colnames(rlts)
colnames(coef2) = colnames(rlts)
colnames(coef3) = colnames(rlts)
colnames(coef4) = colnames(rlts)
colnames(coef5) = colnames(rlts)
colnames(coef6) = colnames(rlts)
rownames(coef1) = var_name_list$EEAs
rownames(coef2) = var_name_list$EEAs
rownames(coef3) = var_name_list$EEAs
rownames(coef4) = var_name_list$EEAs
rownames(coef5) = var_name_list$EEAs
rownames(coef6) = var_name_list$EEAs
coef1$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef2$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef3$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef4$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef5$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef6$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
p1 <- make_forest_plot_lg(coef1, "CUR6_BC_PAH6")
p2 <- make_forest_plot_lg(coef2, "CUR6_PAH31")
p3 <- make_forest_plot_lg(coef3, "CUR6_NkF")
p4 <- make_forest_plot_lg(coef3, "CUR6_PM_RET")
p5 <- make_forest_plot_lg(coef3, "CUR6_NO2")
p6 <- make_forest_plot_lg(coef3, "CUR6_SO2")
plot_list <- list(p1, p2, p3, p4, p5, p6)
# for(j in 1:6){
#   plot_list[[j]] <- plot_list[[j]] + ylim(c(-5, 7))
# }
grid.arrange(grobs = plot_list,  ncol = 2,
top = textGrob(paste("Estimated Effect of each Exposure Prototype \n based on current pollutant exposures"),
gp=gpar(fontsize=15, fontface = 'bold')))
grid.arrange(grobs = plot_list,  ncol = 2,
top = textGrob(paste("Estimated Effect of each Exposure Prototype \n based on current pollutant exposures"),
gp=gpar(fontsize=15, fontface = 'bold')))
rlts_gee <- perform_group_gee(X = var_name_list$cluster_exp$clusCUR6, adjust_cfd = T)
for(j in 1:length(rlts_gee[[2]])){
rlts_gee[[2]][[j]] <- rlts_gee[[2]][[j]] + ylim(c(-2, 2))
}
grid.arrange(grobs = rlts_gee[[2]],  ncol = 2,
top = textGrob(paste("Estimated Effect of each Exposure Prototype \n based on current pollutant exposures"), gp=gpar(fontsize=15, fontface = 'bold')))
for(j in 1:6){
plot_list[[j]] <- plot_list[[j]] + ylim(c(-4, 3.5))
}
grid.arrange(grobs = plot_list,  ncol = 2,
top = textGrob(paste("Estimated Effect of each Exposure Prototype \n based on current pollutant exposures"),
gp=gpar(fontsize=15, fontface = 'bold')))
coef1
cat("The estimated effects:")
for(j in 1:length(rlts_gee[[1]])){
rlts_gee[[1]][[j]] <- rlts_gee[[1]][[j]][, -7] %>%
mutate(coefficient = round(coefficient, 4),
std = round(as.numeric(std), 4),
ci_lower = round(ci_lower, 4),
ci_upper = round(ci_upper, 4),
p_val = round(as.numeric(p_val), 4))
}
print(rlts_gee[[1]])
coef1
coefs_list <- list(coef1, coef2, coef3, coef4, coef5, coef6)
names(coefs_list)
names(coefs_list) <- var_name_list$cluster_exp$clusCUR6
names(coefs_list)
str(coefs_list[[1]])
coefs_list <- list(coef1, coef2, coef3, coef4, coef5, coef6)
cat("The estimated effects:")
for(j in 1:6){
coefs_list[[j]] <- coefs_list[[j]][, -7] %>%
mutate(coefficient = round(coefficient, 4),
std = round(as.numeric(std), 4),
ci_lower = round(ci_lower, 4),
ci_upper = round(ci_upper, 4),
p_val = round(as.numeric(p_val), 4))
}
print(rlts_gee[[1]])
coefs_list <- list(coef1, coef2, coef3, coef4, coef5, coef6)
cat("The estimated effects:")
for(j in 1:6){
coefs_list[[j]] <- coefs_list[[j]][, -7] %>%
mutate(coefficient = round(coefficient, 4),
std = round(as.numeric(std), 4),
ci_lower = round(ci_lower, 4),
ci_upper = round(ci_upper, 4),
p_val = round(as.numeric(p_val), 4))
}
print(coefs_list)
var_name_list$cluster_exp$clusCHLD5
coef1 <- data.frame(matrix(NA, ncol = 6))
coef2 <- data.frame(matrix(NA, ncol = 6))
coef3 <- data.frame(matrix(NA, ncol = 6))
coef4 <- data.frame(matrix(NA, ncol = 6))
coef5 <- data.frame(matrix(NA, ncol = 6))
for(i in 1:length(var_name_list$EEAs)){
rlts = preform_gee_exposure_prototype(X = var_name_list$cluster_exp$clusCHLD5,
Y = var_name_list$EEAs[i])
coef1[i,] <- rlts[2,]
coef2[i,] <- rlts[3,]
coef3[i,] <- rlts[4,]
coef4[i,] <- rlts[5,]
coef5[i,] <- rlts[6,]
}
colnames(coef1) = colnames(rlts)
colnames(coef2) = colnames(rlts)
colnames(coef3) = colnames(rlts)
colnames(coef4) = colnames(rlts)
colnames(coef5) = colnames(rlts)
rownames(coef1) = var_name_list$EEAs
rownames(coef2) = var_name_list$EEAs
rownames(coef3) = var_name_list$EEAs
rownames(coef4) = var_name_list$EEAs
rownames(coef5) = var_name_list$EEAs
coef1$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef2$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef3$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef4$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef5$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
p1 <- make_forest_plot_lg(coef1, "CHLD5_X7")
p2 <- make_forest_plot_lg(coef2, "CHLD5_X33")
p3 <- make_forest_plot_lg(coef3, "CHLD5_NkF")
p4 <- make_forest_plot_lg(coef3, "CHLD5_NO2")
p5 <- make_forest_plot_lg(coef3, "CHLD5_SO2")
plot_list <- list(p1, p2, p3, p4, p5)
for(j in 1:5){
# plot_list[[j]] <- plot_list[[j]] + ylim(c(-4, 3.5))
}
grid.arrange(grobs = plot_list,  ncol = 2,
top = textGrob(paste("Estimated Effect of each Exposure Prototype \n based on childhood pollutant exposures"),
gp=gpar(fontsize=15, fontface = 'bold')))
coef1 <- data.frame(matrix(NA, ncol = 6))
coef2 <- data.frame(matrix(NA, ncol = 6))
coef3 <- data.frame(matrix(NA, ncol = 6))
coef4 <- data.frame(matrix(NA, ncol = 6))
coef5 <- data.frame(matrix(NA, ncol = 6))
for(i in 1:length(var_name_list$EEAs)){
rlts = preform_gee_exposure_prototype(X = var_name_list$cluster_exp$clusCHLD5,
Y = var_name_list$EEAs[i])
coef1[i,] <- rlts[2,]
coef2[i,] <- rlts[3,]
coef3[i,] <- rlts[4,]
coef4[i,] <- rlts[5,]
coef5[i,] <- rlts[6,]
}
colnames(coef1) = colnames(rlts)
colnames(coef2) = colnames(rlts)
colnames(coef3) = colnames(rlts)
colnames(coef4) = colnames(rlts)
colnames(coef5) = colnames(rlts)
rownames(coef1) = var_name_list$EEAs
rownames(coef2) = var_name_list$EEAs
rownames(coef3) = var_name_list$EEAs
rownames(coef4) = var_name_list$EEAs
rownames(coef5) = var_name_list$EEAs
coef1$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef2$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef3$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef4$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef5$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
p1 <- make_forest_plot_lg(coef1, "CHLD5_X7")
p2 <- make_forest_plot_lg(coef2, "CHLD5_X33")
p3 <- make_forest_plot_lg(coef3, "CHLD5_NkF")
p4 <- make_forest_plot_lg(coef4, "CHLD5_NO2")
p5 <- make_forest_plot_lg(coef5, "CHLD5_SO2")
plot_list <- list(p1, p2, p3, p4, p5)
for(j in 1:5){
# plot_list[[j]] <- plot_list[[j]] + ylim(c(-4, 3.5))
}
grid.arrange(grobs = plot_list,  ncol = 2,
top = textGrob(paste("Estimated Effect of each Exposure Prototype \n based on childhood pollutant exposures"),
gp=gpar(fontsize=15, fontface = 'bold')))
for(j in 1:5){
plot_list[[j]] <- plot_list[[j]] + ylim(c(-2.5, 3))
}
grid.arrange(grobs = plot_list,  ncol = 2,
top = textGrob(paste("Estimated Effect of each Exposure Prototype \n based on childhood pollutant exposures"),
gp=gpar(fontsize=15, fontface = 'bold')))
coefs_list <- list(coef1, coef2, coef3, coef4, coef5)
names(coefs_list) <- var_name_list$cluster_exp$clusCHLD5
cat("The estimated effects:")
for(j in 1:6){
coefs_list[[j]] <- coefs_list[[j]][, -7] %>%
mutate(coefficient = round(coefficient, 4),
std = round(as.numeric(std), 4),
ci_lower = round(ci_lower, 4),
ci_upper = round(ci_upper, 4),
p_val = round(as.numeric(p_val), 4))
}
coefs_list <- list(coef1, coef2, coef3, coef4, coef5)
names(coefs_list) <- var_name_list$cluster_exp$clusCHLD5
cat("The estimated effects:")
for(j in 1:5){
coefs_list[[j]] <- coefs_list[[j]][, -7] %>%
mutate(coefficient = round(coefficient, 4),
std = round(as.numeric(std), 4),
ci_lower = round(ci_lower, 4),
ci_upper = round(ci_upper, 4),
p_val = round(as.numeric(p_val), 4))
}
print(coefs_list)
coevar_name_list$cluster_exp$clusCUM6
var_name_list$cluster_exp$clusCUM6
coef1 <- data.frame(matrix(NA, ncol = 6))
coef2 <- data.frame(matrix(NA, ncol = 6))
coef3 <- data.frame(matrix(NA, ncol = 6))
coef4 <- data.frame(matrix(NA, ncol = 6))
coef5 <- data.frame(matrix(NA, ncol = 6))
coef6 <- data.frame(matrix(NA, ncol = 6))
for(i in 1:length(var_name_list$EEAs)){
rlts = preform_gee_exposure_prototype(X = var_name_list$cluster_exp$clusCUM6,
Y = var_name_list$EEAs[i])
coef1[i,] <- rlts[2,]
coef2[i,] <- rlts[3,]
coef3[i,] <- rlts[4,]
coef4[i,] <- rlts[5,]
coef5[i,] <- rlts[6,]
coef6[i,] <- rlts[7,]
}
colnames(coef1) = colnames(rlts)
colnames(coef2) = colnames(rlts)
colnames(coef3) = colnames(rlts)
colnames(coef4) = colnames(rlts)
colnames(coef5) = colnames(rlts)
colnames(coef6) = colnames(rlts)
rownames(coef1) = var_name_list$EEAs
rownames(coef2) = var_name_list$EEAs
rownames(coef3) = var_name_list$EEAs
rownames(coef4) = var_name_list$EEAs
rownames(coef5) = var_name_list$EEAs
rownames(coef6) = var_name_list$EEAs
coef1$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef2$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef3$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef4$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef5$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef6$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
p1 <- make_forest_plot_lg(coef1, "CUR6_BC_PAH6")
p2 <- make_forest_plot_lg(coef2, "CUR6_PAH31")
p3 <- make_forest_plot_lg(coef3, "CUR6_NkF")
p4 <- make_forest_plot_lg(coef4, "CUR6_PM_RET")
p5 <- make_forest_plot_lg(coef5, "CUR6_NO2")
p6 <- make_forest_plot_lg(coef6, "CUR6_SO2")
plot_list <- list(p1, p2, p3, p4, p5, p6)
for(j in 1:6){
#plot_list[[j]] <- plot_list[[j]] + ylim(c(-4, 3.5))
}
grid.arrange(grobs = plot_list,  ncol = 2,
top = textGrob(paste("Estimated Effect of each Exposure Prototype \n based on cumulative pollutant exposures"),
gp=gpar(fontsize=15, fontface = 'bold')))
for(j in 1:6){
plot_list[[j]] <- plot_list[[j]] + ylim(c(-2.5, 3.5))
}
grid.arrange(grobs = plot_list,  ncol = 2,
top = textGrob(paste("Estimated Effect of each Exposure Prototype \n based on cumulative pollutant exposures"),
gp=gpar(fontsize=15, fontface = 'bold')))
coefs_list <- list(coef1, coef2, coef3, coef4, coef5, coef6)
names(coefs_list) <- var_name_list$cluster_exp$clusCUR6
cat("The estimated effects:")
for(j in 1:6){
coefs_list[[j]] <- coefs_list[[j]][, -7] %>%
mutate(coefficient = round(coefficient, 4),
std = round(as.numeric(std), 4),
ci_lower = round(ci_lower, 4),
ci_upper = round(ci_upper, 4),
p_val = round(as.numeric(p_val), 4))
}
print(coefs_list)
coefs_list <- list(coef1, coef2, coef3, coef4, coef5, coef6)
names(coefs_list) <- var_name_list$cluster_exp$clusCUM6
cat("The estimated effects:")
for(j in 1:6){
coefs_list[[j]] <- coefs_list[[j]][, -7] %>%
mutate(coefficient = round(coefficient, 4),
std = round(as.numeric(std), 4),
ci_lower = round(ci_lower, 4),
ci_upper = round(ci_upper, 4),
p_val = round(as.numeric(p_val), 4))
}
print(coefs_list)
var_name_list$cluster_exp$clusMEAS6
var_name_list$cluster_exp$clusCUM6
coef1 <- data.frame(matrix(NA, ncol = 6))
coef2 <- data.frame(matrix(NA, ncol = 6))
coef3 <- data.frame(matrix(NA, ncol = 6))
coef4 <- data.frame(matrix(NA, ncol = 6))
coef5 <- data.frame(matrix(NA, ncol = 6))
coef6 <- data.frame(matrix(NA, ncol = 6))
for(i in 1:length(var_name_list$EEAs)){
rlts = preform_gee_exposure_prototype(X = var_name_list$cluster_exp$clusMEAS6,
Y = var_name_list$EEAs[i])
coef1[i,] <- rlts[2,]
coef2[i,] <- rlts[3,]
coef3[i,] <- rlts[4,]
coef4[i,] <- rlts[5,]
coef5[i,] <- rlts[6,]
coef6[i,] <- rlts[7,]
}
colnames(coef1) = colnames(rlts)
colnames(coef2) = colnames(rlts)
colnames(coef3) = colnames(rlts)
colnames(coef4) = colnames(rlts)
colnames(coef5) = colnames(rlts)
colnames(coef6) = colnames(rlts)
rownames(coef1) = var_name_list$EEAs
rownames(coef2) = var_name_list$EEAs
rownames(coef3) = var_name_list$EEAs
rownames(coef4) = var_name_list$EEAs
rownames(coef5) = var_name_list$EEAs
rownames(coef6) = var_name_list$EEAs
coef1$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef2$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef3$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef4$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef5$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef6$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
p1 <- make_forest_plot_lg(coef1, "MEAS6_BC_PM_RET")
p2 <- make_forest_plot_lg(coef2, "MEAS6_X31")
p3 <- make_forest_plot_lg(coef3, "MEAS6_X5")
p4 <- make_forest_plot_lg(coef4, "MEAS6_DlP")
p5 <- make_forest_plot_lg(coef5, "MEAS6_NkF")
p6 <- make_forest_plot_lg(coef6, "MEAS6_NO2_SO2")
plot_list <- list(p1, p2, p3, p4, p5, p6)
for(j in 1:6){
#plot_list[[j]] <- plot_list[[j]] + ylim(c(-4, 3.5))
}
grid.arrange(grobs = plot_list,  ncol = 2,
top = textGrob(paste("Estimated Effect of each Exposure Prototype \n based on measured pollutant exposures"),
gp=gpar(fontsize=15, fontface = 'bold')))
coef1 <- data.frame(matrix(NA, ncol = 6))
coef2 <- data.frame(matrix(NA, ncol = 6))
coef3 <- data.frame(matrix(NA, ncol = 6))
coef4 <- data.frame(matrix(NA, ncol = 6))
coef5 <- data.frame(matrix(NA, ncol = 6))
coef6 <- data.frame(matrix(NA, ncol = 6))
for(i in 1:length(var_name_list$EEAs)){
rlts = preform_gee_exposure_prototype(X = var_name_list$cluster_exp$clusMEAS6,
Y = var_name_list$EEAs[i])
coef1[i,] <- rlts[2,]
coef2[i,] <- rlts[3,]
coef3[i,] <- rlts[4,]
coef4[i,] <- rlts[5,]
coef5[i,] <- rlts[6,]
coef6[i,] <- rlts[7,]
}
colnames(coef1) = colnames(rlts)
colnames(coef2) = colnames(rlts)
colnames(coef3) = colnames(rlts)
colnames(coef4) = colnames(rlts)
colnames(coef5) = colnames(rlts)
colnames(coef6) = colnames(rlts)
rownames(coef1) = var_name_list$EEAs
rownames(coef2) = var_name_list$EEAs
rownames(coef3) = var_name_list$EEAs
rownames(coef4) = var_name_list$EEAs
rownames(coef5) = var_name_list$EEAs
rownames(coef6) = var_name_list$EEAs
coef1$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef2$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef3$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef4$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef5$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef6$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
p1 <- make_forest_plot_lg(coef1, "MEAS6_BC_PM_RET")
p2 <- make_forest_plot_lg(coef2, "MEAS6_X31")
p3 <- make_forest_plot_lg(coef3, "MEAS6_X5")
p4 <- make_forest_plot_lg(coef4, "MEAS6_DlP")
p5 <- make_forest_plot_lg(coef5, "MEAS6_NkF")
p6 <- make_forest_plot_lg(coef6, "MEAS6_NO2_SO2")
plot_list <- list(p1, p2, p3, p4, p5, p6)
for(j in 1:6){
plot_list[[j]] <- plot_list[[j]] + ylim(c(-6, 6))
}
grid.arrange(grobs = plot_list,  ncol = 2,
top = textGrob(paste("Estimated Effect of each Exposure Prototype \n based on measured pollutant exposures"),
gp=gpar(fontsize=15, fontface = 'bold')))
coefs_list <- list(coef1, coef2, coef3, coef4, coef5, coef6)
names(coefs_list) <- var_name_list$cluster_exp$clusMEAS6
cat("The estimated effects:")
for(j in 1:6){
coefs_list[[j]] <- coefs_list[[j]][, -7] %>%
mutate(coefficient = round(coefficient, 4),
std = round(as.numeric(std), 4),
ci_lower = round(ci_lower, 4),
ci_upper = round(ci_upper, 4),
p_val = round(as.numeric(p_val), 4))
}
print(coefs_list)
var_name_list$cluster_exp$clusURI5
coef1 <- data.frame(matrix(NA, ncol = 6))
coef2 <- data.frame(matrix(NA, ncol = 6))
coef3 <- data.frame(matrix(NA, ncol = 6))
coef4 <- data.frame(matrix(NA, ncol = 6))
coef5 <- data.frame(matrix(NA, ncol = 6))
for(i in 1:length(var_name_list$EEAs)){
rlts = preform_gee_exposure_prototype(X = var_name_list$cluster_exp$clusURI5,
Y = var_name_list$EEAs[i])
coef1[i,] <- rlts[2,]
coef2[i,] <- rlts[3,]
coef3[i,] <- rlts[4,]
coef4[i,] <- rlts[5,]
coef5[i,] <- rlts[6,]
}
colnames(coef1) = colnames(rlts)
colnames(coef2) = colnames(rlts)
colnames(coef3) = colnames(rlts)
colnames(coef4) = colnames(rlts)
colnames(coef5) = colnames(rlts)
rownames(coef1) = var_name_list$EEAs
rownames(coef2) = var_name_list$EEAs
rownames(coef3) = var_name_list$EEAs
rownames(coef4) = var_name_list$EEAs
rownames(coef5) = var_name_list$EEAs
coef1$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef2$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef3$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef4$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef5$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
p1 <- make_forest_plot_lg(coef1, "URI5_NAP_1M_2M")
p2 <- make_forest_plot_lg(coef2, "URI5_ACE")
p3 <- make_forest_plot_lg(coef3, "URI5_FLU_PHE")
p4 <- make_forest_plot_lg(coef4, "URI5_PYR")
p5 <- make_forest_plot_lg(coef5, "URI5_CHR")
plot_list <- list(p1, p2, p3, p4, p5)
for(j in 1:5){
# plot_list[[j]] <- plot_list[[j]] + ylim(c(-4, 3.5))
}
grid.arrange(grobs = plot_list,  ncol = 2,
top = textGrob(paste("Estimated Effect of each Exposure Prototype \n based on measured urinary biomarkers"),
gp=gpar(fontsize=15, fontface = 'bold')))
coef1 <- data.frame(matrix(NA, ncol = 6))
coef2 <- data.frame(matrix(NA, ncol = 6))
coef3 <- data.frame(matrix(NA, ncol = 6))
coef4 <- data.frame(matrix(NA, ncol = 6))
coef5 <- data.frame(matrix(NA, ncol = 6))
for(i in 1:length(var_name_list$EEAs)){
rlts = preform_gee_exposure_prototype(X = var_name_list$cluster_exp$clusURI5,
Y = var_name_list$EEAs[i])
coef1[i,] <- rlts[2,]
coef2[i,] <- rlts[3,]
coef3[i,] <- rlts[4,]
coef4[i,] <- rlts[5,]
coef5[i,] <- rlts[6,]
}
colnames(coef1) = colnames(rlts)
colnames(coef2) = colnames(rlts)
colnames(coef3) = colnames(rlts)
colnames(coef4) = colnames(rlts)
colnames(coef5) = colnames(rlts)
rownames(coef1) = var_name_list$EEAs
rownames(coef2) = var_name_list$EEAs
rownames(coef3) = var_name_list$EEAs
rownames(coef4) = var_name_list$EEAs
rownames(coef5) = var_name_list$EEAs
coef1$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef2$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef3$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef4$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
coef5$EAAs = factor(EAAs_names, levels=rev(c(EAAs_names[EAAs_names != "DNAmTL"], "DNAmTL")))
p1 <- make_forest_plot_lg(coef1, "URI5_NAP_1M_2M")
p2 <- make_forest_plot_lg(coef2, "URI5_ACE")
p3 <- make_forest_plot_lg(coef3, "URI5_FLU_PHE")
p4 <- make_forest_plot_lg(coef4, "URI5_PYR")
p5 <- make_forest_plot_lg(coef5, "URI5_CHR")
plot_list <- list(p1, p2, p3, p4, p5)
for(j in 1:5){
plot_list[[j]] <- plot_list[[j]] + ylim(c(-8, 8))
}
grid.arrange(grobs = plot_list,  ncol = 2,
top = textGrob(paste("Estimated Effect of each Exposure Prototype \n based on measured urinary biomarkers"),
gp=gpar(fontsize=15, fontface = 'bold')))
coefs_list <- list(coef1, coef2, coef3, coef4, coef5)
names(coefs_list) <- var_name_list$cluster_exp$clusURI5
cat("The estimated effects:")
for(j in 1:5){
coefs_list[[j]] <- coefs_list[[j]][, -7] %>%
mutate(coefficient = round(coefficient, 4),
std = round(as.numeric(std), 4),
ci_lower = round(ci_lower, 4),
ci_upper = round(ci_upper, 4),
p_val = round(as.numeric(p_val), 4))
}
print(coefs_list)
